{"speedup": 1.5606414607482133, "f1": 90.26969803251558, "meta": {"annotate": "45", "cat_fun_name": "is_new_xp", "checkpoint": {"config": {"_name_or_path": "/home/lagunas/devel/hf/nn_pruning/nn_pruning/analysis/tmp_finetune", "architectures": ["BertForQuestionAnswering"], "attention_probs_dropout_prob": 0.1, "gradient_checkpointing": false, "hidden_act": "gelu", "hidden_dropout_prob": 0.1, "hidden_size": 768, "initializer_range": 0.02, "intermediate_size": 3072, "layer_norm_eps": 1e-12, "max_position_embeddings": 512, "model_type": "bert", "num_attention_heads": 12, "num_hidden_layers": 12, "pad_token_id": 0, "position_embedding_type": "absolute", "pruned_heads": {"0": [0], "1": [0, 2, 3], "10": [1, 4, 7], "11": [8, 5, 7], "2": [8, 4], "3": [2, 4], "4": [], "5": [1, 2], "6": [3], "7": [11, 3, 6, 7], "8": [], "9": [1, 4, 5, 7]}, "type_vocab_size": 2, "vocab_size": 30522}, "eval_metrics": {"exact_match": 83.72753074739829, "f1": 90.26969803251558}, "path": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold:--d169c0ebde721c7/checkpoint-55000", "source_checkpoint": "/data_2to/devel_data/nn_pruning/output/squad_test4/hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold:--d169c0ebde721c7/checkpoint-110000", "sparse_args": {"ampere_pruning_method": "disabled", "attention_block_cols": 1, "attention_block_rows": 1, "attention_lambda": 1.0, "attention_output_with_dense": 0, "attention_pruning_method": "topK", "bias_mask": true, "dense_block_cols": 1, "dense_block_rows": 1, "dense_lambda": 1.0, "dense_pruning_method": "topK", "distil_alpha_ce": 0.1, "distil_alpha_teacher": 0.9, "distil_teacher_name_or_path": "bert-large-uncased-whole-word-masking-finetuned-squad", "distil_temperature": 2.0, "final_ampere_temperature": 20.0, "final_finetune": 1, "final_threshold": 0.5, "final_warmup": 0, "initial_ampere_temperature": 0.0, "initial_threshold": 1.0, "initial_warmup": 0, "mask_init": "constant", "mask_scale": 0.0, "mask_scores_learning_rate": 0.01, "regularization": "", "regularization_final_lambda": 0}, "speed": {"cuda_eval_elapsed_time": 24.729826789855956, "eval_elapsed_time": 31.979490760713816}, "speedup": 1.5606414607482133, "stats": {"layers": {"0": {"linear_attention_nnz": 2162688, "linear_attention_total": 2359296, "linear_dense_nnz": 1720320, "linear_dense_total": 4718592, "linear_nnz": 3883008, "linear_total": 7077888, "nnz": 3890848, "total": 7087680}, "1": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 1815552, "linear_dense_total": 4718592, "linear_nnz": 3585024, "linear_total": 7077888, "nnz": 3592542, "total": 7087296}, "10": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 391680, "linear_dense_total": 4718592, "linear_nnz": 2161152, "linear_total": 7077888, "nnz": 2167743, "total": 7087296}, "11": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 638976, "linear_dense_total": 4718592, "linear_nnz": 2408448, "linear_total": 7077888, "nnz": 2415200, "total": 7087296}, "2": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 1961472, "linear_dense_total": 4718592, "linear_nnz": 3927552, "linear_total": 7077888, "nnz": 3935357, "total": 7087488}, "3": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 1981440, "linear_dense_total": 4718592, "linear_nnz": 3947520, "linear_total": 7077888, "nnz": 3955338, "total": 7087488}, "4": {"linear_attention_nnz": 2359296, "linear_attention_total": 2359296, "linear_dense_nnz": 1850880, "linear_dense_total": 4718592, "linear_nnz": 4210176, "linear_total": 7077888, "nnz": 4218293, "total": 7087872}, "5": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 1752576, "linear_dense_total": 4718592, "linear_nnz": 3718656, "linear_total": 7077888, "nnz": 3726325, "total": 7087488}, "6": {"linear_attention_nnz": 2162688, "linear_attention_total": 2359296, "linear_dense_nnz": 1350144, "linear_dense_total": 4718592, "linear_nnz": 3512832, "linear_total": 7077888, "nnz": 3520431, "total": 7087680}, "7": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 1013760, "linear_dense_total": 4718592, "linear_nnz": 2586624, "linear_total": 7077888, "nnz": 2593428, "total": 7087104}, "8": {"linear_attention_nnz": 2359296, "linear_attention_total": 2359296, "linear_dense_nnz": 511488, "linear_dense_total": 4718592, "linear_nnz": 2870784, "linear_total": 7077888, "nnz": 2878029, "total": 7087872}, "9": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 254976, "linear_dense_total": 4718592, "linear_nnz": 1827840, "linear_total": 7077888, "nnz": 1834150, "total": 7087104}}, "linear_nnz": 38639616, "linear_sparsity": 54.506655092592595, "linear_total": 84934656, "nnz": 62566406, "pruned_heads": {"0": [0], "1": [0, 2, 3], "10": [1, 4, 7], "11": [8, 5, 7], "2": [8, 4], "3": [2, 4], "4": [], "5": [1, 2], "6": [3], "7": [11, 3, 6, 7], "8": [], "9": [1, 4, 5, 7]}, "total": 108888386, "total_sparsity": 42.54079034654807}, "training_args": {"_n_gpu": -1, "adafactor": false, "adam_beta1": 0.9, "adam_beta2": 0.999, "adam_epsilon": 1e-08, "dataloader_drop_last": false, "dataloader_num_workers": 0, "dataloader_pin_memory": true, "ddp_find_unused_parameters": null, "debug": false, "deepspeed": null, "disable_tqdm": false, "do_eval": 1, "do_predict": false, "do_train": 1, "eval_accumulation_steps": null, "eval_steps": 2500, "evaluation_strategy": "steps", "fp16": false, "fp16_backend": "auto", "fp16_full_eval": false, "fp16_opt_level": "O1", "gradient_accumulation_steps": 1, "greater_is_better": null, "group_by_length": false, "ignore_data_skip": false, "label_names": null, "label_smoothing_factor": 0.0, "learning_rate": 3e-05, "load_best_model_at_end": false, "local_rank": -1, "logging_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold:--d169c0ebde721c7", "logging_first_step": false, "logging_steps": 250, "logging_strategy": "steps", "lr_scheduler_type": "linear", "max_grad_norm": 1.0, "max_steps": -1, "metric_for_best_model": null, "no_cuda": false, "num_train_epochs": 10, "optimize_model_before_eval": "disabled", "output_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold:--d169c0ebde721c7", "overwrite_output_dir": 1, "past_index": -1, "per_device_eval_batch_size": 128, "per_device_train_batch_size": 16, "per_gpu_eval_batch_size": null, "per_gpu_train_batch_size": null, "prediction_loss_only": false, "remove_unused_columns": true, "report_to": null, "run_name": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold:--d169c0ebde721c7", "save_steps": 2500, "save_strategy": "steps", "save_total_limit": 50, "seed": 17, "sharded_ddp": "", "skip_memory_metrics": false, "tpu_metrics_debug": false, "tpu_num_cores": null, "warmup_ratio": 0.0, "warmup_steps": 10, "weight_decay": 0.0}}, "f1": 90.26969803251558, "fill_rate": 0.45493344907407407, "speedup": 1.5606414607482133}}
{"speedup": 1.8333442967227587, "f1": 89.81145528969563, "meta": {"annotate": "35", "cat_fun_name": "is_new_xp", "checkpoint": {"config": {"_name_or_path": "/home/lagunas/devel/hf/nn_pruning/nn_pruning/analysis/tmp_finetune", "architectures": ["BertForQuestionAnswering"], "attention_probs_dropout_prob": 0.1, "gradient_checkpointing": false, "hidden_act": "gelu", "hidden_dropout_prob": 0.1, "hidden_size": 768, "initializer_range": 0.02, "intermediate_size": 3072, "layer_norm_eps": 1e-12, "max_position_embeddings": 512, "model_type": "bert", "num_attention_heads": 12, "num_hidden_layers": 12, "pad_token_id": 0, "position_embedding_type": "absolute", "pruned_heads": {"0": [0, 4, 5, 6], "1": [0, 2, 3, 5, 6, 8], "10": [1, 4, 5, 6, 7], "11": [8, 10, 5, 7], "2": [8, 4], "3": [2, 4, 6], "4": [1], "5": [1, 2], "6": [2, 3], "7": [11, 3, 6, 7], "8": [0, 3, 4], "9": [1, 4, 5, 7, 10]}, "type_vocab_size": 2, "vocab_size": 30522}, "eval_metrics": {"exact_match": 82.95175023651845, "f1": 89.81145528969563}, "path": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--6b3d26fc7262a898/checkpoint-47500", "source_checkpoint": "/data_2to/devel_data/nn_pruning/output/squad_test4/hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--6b3d26fc7262a898/checkpoint-110000", "sparse_args": {"ampere_pruning_method": "disabled", "attention_block_cols": 1, "attention_block_rows": 1, "attention_lambda": 1.0, "attention_output_with_dense": 0, "attention_pruning_method": "topK", "bias_mask": true, "dense_block_cols": 1, "dense_block_rows": 1, "dense_lambda": 1.0, "dense_pruning_method": "topK", "distil_alpha_ce": 0.1, "distil_alpha_teacher": 0.9, "distil_teacher_name_or_path": "bert-large-uncased-whole-word-masking-finetuned-squad", "distil_temperature": 2.0, "final_ampere_temperature": 20.0, "final_finetune": 1, "final_threshold": 0.5, "final_warmup": 0, "initial_ampere_temperature": 0.0, "initial_threshold": 1.0, "initial_warmup": 0, "mask_init": "constant", "mask_scale": 0.0, "mask_scores_learning_rate": 0.01, "regularization": "", "regularization_final_lambda": 0}, "speed": {"cuda_eval_elapsed_time": 21.051361206054686, "eval_elapsed_time": 28.537553551606834}, "speedup": 1.8333442967227587, "stats": {"layers": {"0": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 964608, "linear_dense_total": 4718592, "linear_nnz": 2537472, "linear_total": 7077888, "nnz": 2544244, "total": 7087104}, "1": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 1202688, "linear_dense_total": 4718592, "linear_nnz": 2382336, "linear_total": 7077888, "nnz": 2388879, "total": 7086720}, "10": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 256512, "linear_dense_total": 4718592, "linear_nnz": 1632768, "linear_total": 7077888, "nnz": 1638887, "total": 7086912}, "11": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 400896, "linear_dense_total": 4718592, "linear_nnz": 1973760, "linear_total": 7077888, "nnz": 1980165, "total": 7087104}, "2": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 1281024, "linear_dense_total": 4718592, "linear_nnz": 3247104, "linear_total": 7077888, "nnz": 3254466, "total": 7087488}, "3": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 1319424, "linear_dense_total": 4718592, "linear_nnz": 3088896, "linear_total": 7077888, "nnz": 3096091, "total": 7087296}, "4": {"linear_attention_nnz": 2162688, "linear_attention_total": 2359296, "linear_dense_nnz": 1288704, "linear_dense_total": 4718592, "linear_nnz": 3451392, "linear_total": 7077888, "nnz": 3458951, "total": 7087680}, "5": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 1210368, "linear_dense_total": 4718592, "linear_nnz": 3176448, "linear_total": 7077888, "nnz": 3183764, "total": 7087488}, "6": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 940032, "linear_dense_total": 4718592, "linear_nnz": 2906112, "linear_total": 7077888, "nnz": 2913252, "total": 7087488}, "7": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 662016, "linear_dense_total": 4718592, "linear_nnz": 2234880, "linear_total": 7077888, "nnz": 2241455, "total": 7087104}, "8": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 348672, "linear_dense_total": 4718592, "linear_nnz": 2118144, "linear_total": 7077888, "nnz": 2124707, "total": 7087296}, "9": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 159744, "linear_dense_total": 4718592, "linear_nnz": 1536000, "linear_total": 7077888, "nnz": 1542056, "total": 7086912}}, "linear_nnz": 30285312, "linear_sparsity": 64.3428096064815, "linear_total": 84934656, "nnz": 54205639, "pruned_heads": {"0": [0, 4, 5, 6], "1": [0, 2, 3, 5, 6, 8], "10": [1, 4, 5, 6, 7], "11": [8, 10, 5, 7], "2": [8, 4], "3": [2, 4, 6], "4": [1], "5": [1, 2], "6": [2, 3], "7": [11, 3, 6, 7], "8": [0, 3, 4], "9": [1, 4, 5, 7, 10]}, "total": 108885314, "total_sparsity": 50.21767673829732}, "training_args": {"_n_gpu": -1, "adafactor": false, "adam_beta1": 0.9, "adam_beta2": 0.999, "adam_epsilon": 1e-08, "dataloader_drop_last": false, "dataloader_num_workers": 0, "dataloader_pin_memory": true, "ddp_find_unused_parameters": null, "debug": false, "deepspeed": null, "disable_tqdm": false, "do_eval": 1, "do_predict": false, "do_train": 1, "eval_accumulation_steps": null, "eval_steps": 2500, "evaluation_strategy": "steps", "fp16": false, "fp16_backend": "auto", "fp16_full_eval": false, "fp16_opt_level": "O1", "gradient_accumulation_steps": 1, "greater_is_better": null, "group_by_length": false, "ignore_data_skip": false, "label_names": null, "label_smoothing_factor": 0.0, "learning_rate": 3e-05, "load_best_model_at_end": false, "local_rank": -1, "logging_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--6b3d26fc7262a898", "logging_first_step": false, "logging_steps": 250, "logging_strategy": "steps", "lr_scheduler_type": "linear", "max_grad_norm": 1.0, "max_steps": -1, "metric_for_best_model": null, "no_cuda": false, "num_train_epochs": 10, "optimize_model_before_eval": "disabled", "output_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--6b3d26fc7262a898", "overwrite_output_dir": 1, "past_index": -1, "per_device_eval_batch_size": 128, "per_device_train_batch_size": 16, "per_gpu_eval_batch_size": null, "per_gpu_train_batch_size": null, "prediction_loss_only": false, "remove_unused_columns": true, "report_to": null, "run_name": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--6b3d26fc7262a898", "save_steps": 2500, "save_strategy": "steps", "save_total_limit": 50, "seed": 17, "sharded_ddp": "", "skip_memory_metrics": false, "tpu_metrics_debug": false, "tpu_num_cores": null, "warmup_ratio": 0.0, "warmup_steps": 10, "weight_decay": 0.0}}, "f1": 89.81145528969563, "fill_rate": 0.356571903935185, "speedup": 1.8333442967227587}}
{"speedup": 2.075387764969063, "f1": 89.00029318511001, "meta": {"annotate": "29", "cat_fun_name": "is_new_xp", "checkpoint": {"config": {"_name_or_path": "/home/lagunas/devel/hf/nn_pruning/nn_pruning/analysis/tmp_finetune", "architectures": ["BertForQuestionAnswering"], "attention_probs_dropout_prob": 0.1, "gradient_checkpointing": false, "hidden_act": "gelu", "hidden_dropout_prob": 0.1, "hidden_size": 768, "initializer_range": 0.02, "intermediate_size": 3072, "layer_norm_eps": 1e-12, "max_position_embeddings": 512, "model_type": "bert", "num_attention_heads": 12, "num_hidden_layers": 12, "pad_token_id": 0, "position_embedding_type": "absolute", "pruned_heads": {"0": [0, 2, 4, 5, 6], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 4, 5, 6, 7, 8], "11": [2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6], "4": [1, 2], "5": [1, 2, 6], "6": [2, 3], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "type_vocab_size": 2, "vocab_size": 30522}, "eval_metrics": {"exact_match": 81.97729422894986, "f1": 89.00029318511001}, "path": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--754f92d6579864ca/checkpoint-52500", "source_checkpoint": "/data_2to/devel_data/nn_pruning/output/squad_test4/hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--754f92d6579864ca/checkpoint-95000", "sparse_args": {"ampere_pruning_method": "disabled", "attention_block_cols": 1, "attention_block_rows": 1, "attention_lambda": 1.0, "attention_output_with_dense": 0, "attention_pruning_method": "topK", "bias_mask": true, "dense_block_cols": 1, "dense_block_rows": 1, "dense_lambda": 1.0, "dense_pruning_method": "topK", "distil_alpha_ce": 0.1, "distil_alpha_teacher": 0.9, "distil_teacher_name_or_path": "bert-large-uncased-whole-word-masking-finetuned-squad", "distil_temperature": 2.0, "final_ampere_temperature": 20.0, "final_finetune": 1, "final_threshold": 0.5, "final_warmup": 0, "initial_ampere_temperature": 0.0, "initial_threshold": 1.0, "initial_warmup": 0, "mask_init": "constant", "mask_scale": 0.0, "mask_scores_learning_rate": 0.01, "regularization": "", "regularization_final_lambda": 0}, "speed": {"cuda_eval_elapsed_time": 18.596232307434082, "eval_elapsed_time": 25.85930221248418}, "speedup": 2.075387764969063, "stats": {"layers": {"0": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 543744, "linear_dense_total": 4718592, "linear_nnz": 1920000, "linear_total": 7077888, "nnz": 1926306, "total": 7086912}, "1": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 764928, "linear_dense_total": 4718592, "linear_nnz": 1747968, "linear_total": 7077888, "nnz": 1754034, "total": 7086528}, "10": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 176640, "linear_dense_total": 4718592, "linear_nnz": 1356288, "linear_total": 7077888, "nnz": 1362163, "total": 7086720}, "11": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 259584, "linear_dense_total": 4718592, "linear_nnz": 1439232, "linear_total": 7077888, "nnz": 1445161, "total": 7086720}, "2": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 835584, "linear_dense_total": 4718592, "linear_nnz": 2605056, "linear_total": 7077888, "nnz": 2611936, "total": 7087296}, "3": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 866304, "linear_dense_total": 4718592, "linear_nnz": 2635776, "linear_total": 7077888, "nnz": 2642676, "total": 7087296}, "4": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 893952, "linear_dense_total": 4718592, "linear_nnz": 2860032, "linear_total": 7077888, "nnz": 2867142, "total": 7087488}, "5": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 797184, "linear_dense_total": 4718592, "linear_nnz": 2566656, "linear_total": 7077888, "nnz": 2573511, "total": 7087296}, "6": {"linear_attention_nnz": 1966080, "linear_attention_total": 2359296, "linear_dense_nnz": 637440, "linear_dense_total": 4718592, "linear_nnz": 2603520, "linear_total": 7077888, "nnz": 2610463, "total": 7087488}, "7": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 473088, "linear_dense_total": 4718592, "linear_nnz": 1849344, "linear_total": 7077888, "nnz": 1855604, "total": 7086912}, "8": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 241152, "linear_dense_total": 4718592, "linear_nnz": 1814016, "linear_total": 7077888, "nnz": 1820317, "total": 7087104}, "9": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 119808, "linear_dense_total": 4718592, "linear_nnz": 1299456, "linear_total": 7077888, "nnz": 1305294, "total": 7086720}}, "linear_nnz": 24697344, "linear_sparsity": 70.92194733796296, "linear_total": 84934656, "nnz": 48613329, "pruned_heads": {"0": [0, 2, 4, 5, 6], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 4, 5, 6, 7, 8], "11": [2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6], "4": [1, 2], "5": [1, 2, 6], "6": [2, 3], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "total": 108883202, "total_sparsity": 55.352774250705814}, "training_args": {"_n_gpu": -1, "adafactor": false, "adam_beta1": 0.9, "adam_beta2": 0.999, "adam_epsilon": 1e-08, "dataloader_drop_last": false, "dataloader_num_workers": 0, "dataloader_pin_memory": true, "ddp_find_unused_parameters": null, "debug": false, "deepspeed": null, "disable_tqdm": false, "do_eval": 1, "do_predict": false, "do_train": 1, "eval_accumulation_steps": null, "eval_steps": 2500, "evaluation_strategy": "steps", "fp16": false, "fp16_backend": "auto", "fp16_full_eval": false, "fp16_opt_level": "O1", "gradient_accumulation_steps": 1, "greater_is_better": null, "group_by_length": false, "ignore_data_skip": false, "label_names": null, "label_smoothing_factor": 0.0, "learning_rate": 3e-05, "load_best_model_at_end": false, "local_rank": -1, "logging_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--754f92d6579864ca", "logging_first_step": false, "logging_steps": 250, "logging_strategy": "steps", "lr_scheduler_type": "linear", "max_grad_norm": 1.0, "max_steps": -1, "metric_for_best_model": null, "no_cuda": false, "num_train_epochs": 10, "optimize_model_before_eval": "disabled", "output_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--754f92d6579864ca", "overwrite_output_dir": 1, "past_index": -1, "per_device_eval_batch_size": 128, "per_device_train_batch_size": 16, "per_gpu_eval_batch_size": null, "per_gpu_train_batch_size": null, "prediction_loss_only": false, "remove_unused_columns": true, "report_to": null, "run_name": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--754f92d6579864ca", "save_steps": 2500, "save_strategy": "steps", "save_total_limit": 50, "seed": 17, "sharded_ddp": "", "skip_memory_metrics": false, "tpu_metrics_debug": false, "tpu_num_cores": null, "warmup_ratio": 0.0, "warmup_steps": 10, "weight_decay": 0.0}}, "f1": 89.00029318511001, "fill_rate": 0.29078052662037035, "speedup": 2.075387764969063}}
{"speedup": 2.306354828560857, "f1": 88.30880074775172, "meta": {"annotate": "23", "cat_fun_name": "is_new_xp", "checkpoint": {"config": {"_name_or_path": "/home/lagunas/devel/hf/nn_pruning/nn_pruning/analysis/tmp_finetune", "architectures": ["BertForQuestionAnswering"], "attention_probs_dropout_prob": 0.1, "gradient_checkpointing": false, "hidden_act": "gelu", "hidden_dropout_prob": 0.1, "hidden_size": 768, "initializer_range": 0.02, "intermediate_size": 3072, "layer_norm_eps": 1e-12, "max_position_embeddings": 512, "model_type": "bert", "num_attention_heads": 12, "num_hidden_layers": 12, "pad_token_id": 0, "position_embedding_type": "absolute", "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 11], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6, 7], "4": [1, 2, 11], "5": [1, 2, 5, 6, 7, 11], "6": [10, 2, 3, 7], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "type_vocab_size": 2, "vocab_size": 30522}, "eval_metrics": {"exact_match": 81.16367076631977, "f1": 88.30880074775172}, "path": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746/checkpoint-47500", "source_checkpoint": "/data_2to/devel_data/nn_pruning/output/squad_test4/hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746/checkpoint-110000", "sparse_args": {"ampere_pruning_method": "disabled", "attention_block_cols": 1, "attention_block_rows": 1, "attention_lambda": 1.0, "attention_output_with_dense": 0, "attention_pruning_method": "topK", "bias_mask": true, "dense_block_cols": 1, "dense_block_rows": 1, "dense_lambda": 1.0, "dense_pruning_method": "topK", "distil_alpha_ce": 0.1, "distil_alpha_teacher": 0.9, "distil_teacher_name_or_path": "bert-large-uncased-whole-word-masking-finetuned-squad", "distil_temperature": 2.0, "final_ampere_temperature": 20.0, "final_finetune": 1, "final_threshold": 0.5, "final_warmup": 0, "initial_ampere_temperature": 0.0, "initial_threshold": 1.0, "initial_warmup": 0, "mask_init": "constant", "mask_scale": 0.0, "mask_scores_learning_rate": 0.01, "regularization": "", "regularization_final_lambda": 0}, "speed": {"cuda_eval_elapsed_time": 16.733935527801513, "eval_elapsed_time": 23.897289094515145}, "speedup": 2.306354828560857, "stats": {"layers": {"0": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 310272, "linear_dense_total": 4718592, "linear_nnz": 1293312, "linear_total": 7077888, "nnz": 1299082, "total": 7086528}, "1": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 436224, "linear_dense_total": 4718592, "linear_nnz": 1419264, "linear_total": 7077888, "nnz": 1425116, "total": 7086528}, "10": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 121344, "linear_dense_total": 4718592, "linear_nnz": 1104384, "linear_total": 7077888, "nnz": 1110031, "total": 7086528}, "11": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 156672, "linear_dense_total": 4718592, "linear_nnz": 1139712, "linear_total": 7077888, "nnz": 1145382, "total": 7086528}, "2": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 543744, "linear_dense_total": 4718592, "linear_nnz": 2313216, "linear_total": 7077888, "nnz": 2319906, "total": 7087296}, "3": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 565248, "linear_dense_total": 4718592, "linear_nnz": 2138112, "linear_total": 7077888, "nnz": 2144624, "total": 7087104}, "4": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 589824, "linear_dense_total": 4718592, "linear_nnz": 2359296, "linear_total": 7077888, "nnz": 2366016, "total": 7087296}, "5": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 514560, "linear_dense_total": 4718592, "linear_nnz": 1694208, "linear_total": 7077888, "nnz": 1700303, "total": 7086720}, "6": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 442368, "linear_dense_total": 4718592, "linear_nnz": 2015232, "linear_total": 7077888, "nnz": 2021664, "total": 7087104}, "7": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 322560, "linear_dense_total": 4718592, "linear_nnz": 1698816, "linear_total": 7077888, "nnz": 1704978, "total": 7086912}, "8": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 167424, "linear_dense_total": 4718592, "linear_nnz": 1740288, "linear_total": 7077888, "nnz": 1746541, "total": 7087104}, "9": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 84480, "linear_dense_total": 4718592, "linear_nnz": 1264128, "linear_total": 7077888, "nnz": 1269943, "total": 7086720}}, "linear_nnz": 20179968, "linear_sparsity": 76.24059606481481, "linear_total": 84934656, "nnz": 44092308, "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 11], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6, 7], "4": [1, 2, 11], "5": [1, 2, 5, 6, 7, 11], "6": [10, 2, 3, 7], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "total": 108881090, "total_sparsity": 59.50416367066127}, "training_args": {"_n_gpu": -1, "adafactor": false, "adam_beta1": 0.9, "adam_beta2": 0.999, "adam_epsilon": 1e-08, "dataloader_drop_last": false, "dataloader_num_workers": 0, "dataloader_pin_memory": true, "ddp_find_unused_parameters": null, "debug": false, "deepspeed": null, "disable_tqdm": false, "do_eval": 1, "do_predict": false, "do_train": 1, "eval_accumulation_steps": null, "eval_steps": 2500, "evaluation_strategy": "steps", "fp16": false, "fp16_backend": "auto", "fp16_full_eval": false, "fp16_opt_level": "O1", "gradient_accumulation_steps": 1, "greater_is_better": null, "group_by_length": false, "ignore_data_skip": false, "label_names": null, "label_smoothing_factor": 0.0, "learning_rate": 3e-05, "load_best_model_at_end": false, "local_rank": -1, "logging_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "logging_first_step": false, "logging_steps": 250, "logging_strategy": "steps", "lr_scheduler_type": "linear", "max_grad_norm": 1.0, "max_steps": -1, "metric_for_best_model": null, "no_cuda": false, "num_train_epochs": 10, "optimize_model_before_eval": "disabled", "output_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "overwrite_output_dir": 1, "past_index": -1, "per_device_eval_batch_size": 128, "per_device_train_batch_size": 16, "per_gpu_eval_batch_size": null, "per_gpu_train_batch_size": null, "prediction_loss_only": false, "remove_unused_columns": true, "report_to": null, "run_name": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "save_steps": 2500, "save_strategy": "steps", "save_total_limit": 50, "seed": 17, "sharded_ddp": "", "skip_memory_metrics": false, "tpu_metrics_debug": false, "tpu_num_cores": null, "warmup_ratio": 0.0, "warmup_steps": 10, "weight_decay": 0.0}}, "f1": 88.30880074775172, "fill_rate": 0.23759403935185186, "speedup": 2.306354828560857}}
{"speedup": 2.363378950512201, "f1": 88.25975710073095, "meta": {"annotate": "23", "cat_fun_name": "is_new_xp", "checkpoint": {"config": {"_name_or_path": "/home/lagunas/devel/hf/nn_pruning/nn_pruning/analysis/tmp_finetune", "architectures": ["BertForQuestionAnswering"], "attention_probs_dropout_prob": 0.1, "gradient_checkpointing": false, "hidden_act": "gelu", "hidden_dropout_prob": 0.1, "hidden_size": 768, "initializer_range": 0.02, "intermediate_size": 3072, "layer_norm_eps": 1e-12, "max_position_embeddings": 512, "model_type": "bert", "num_attention_heads": 12, "num_hidden_layers": 12, "pad_token_id": 0, "position_embedding_type": "absolute", "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 11], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6, 7], "4": [1, 2, 11], "5": [1, 2, 5, 6, 7, 11], "6": [10, 2, 3, 7], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "type_vocab_size": 2, "vocab_size": 30522}, "eval_metrics": {"exact_match": 81.01229895931883, "f1": 88.25975710073095}, "path": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746/checkpoint-52500", "source_checkpoint": "/data_2to/devel_data/nn_pruning/output/squad_test4/hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746/checkpoint-110000", "sparse_args": {"ampere_pruning_method": "disabled", "attention_block_cols": 1, "attention_block_rows": 1, "attention_lambda": 1.0, "attention_output_with_dense": 0, "attention_pruning_method": "topK", "bias_mask": true, "dense_block_cols": 1, "dense_block_rows": 1, "dense_lambda": 1.0, "dense_pruning_method": "topK", "distil_alpha_ce": 0.1, "distil_alpha_teacher": 0.9, "distil_teacher_name_or_path": "bert-large-uncased-whole-word-masking-finetuned-squad", "distil_temperature": 2.0, "final_ampere_temperature": 20.0, "final_finetune": 1, "final_threshold": 0.5, "final_warmup": 0, "initial_ampere_temperature": 0.0, "initial_threshold": 1.0, "initial_warmup": 0, "mask_init": "constant", "mask_scale": 0.0, "mask_scores_learning_rate": 0.01, "regularization": "", "regularization_final_lambda": 0}, "speed": {"cuda_eval_elapsed_time": 16.33017548751831, "eval_elapsed_time": 23.592021488584578}, "speedup": 2.363378950512201, "stats": {"layers": {"0": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 310272, "linear_dense_total": 4718592, "linear_nnz": 1293312, "linear_total": 7077888, "nnz": 1299082, "total": 7086528}, "1": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 436224, "linear_dense_total": 4718592, "linear_nnz": 1419264, "linear_total": 7077888, "nnz": 1425116, "total": 7086528}, "10": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 121344, "linear_dense_total": 4718592, "linear_nnz": 1104384, "linear_total": 7077888, "nnz": 1110031, "total": 7086528}, "11": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 156672, "linear_dense_total": 4718592, "linear_nnz": 1139712, "linear_total": 7077888, "nnz": 1145382, "total": 7086528}, "2": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 543744, "linear_dense_total": 4718592, "linear_nnz": 2313216, "linear_total": 7077888, "nnz": 2319906, "total": 7087296}, "3": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 565248, "linear_dense_total": 4718592, "linear_nnz": 2138112, "linear_total": 7077888, "nnz": 2144624, "total": 7087104}, "4": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 589824, "linear_dense_total": 4718592, "linear_nnz": 2359296, "linear_total": 7077888, "nnz": 2366016, "total": 7087296}, "5": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 514560, "linear_dense_total": 4718592, "linear_nnz": 1694208, "linear_total": 7077888, "nnz": 1700303, "total": 7086720}, "6": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 442368, "linear_dense_total": 4718592, "linear_nnz": 2015232, "linear_total": 7077888, "nnz": 2021664, "total": 7087104}, "7": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 322560, "linear_dense_total": 4718592, "linear_nnz": 1698816, "linear_total": 7077888, "nnz": 1704978, "total": 7086912}, "8": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 167424, "linear_dense_total": 4718592, "linear_nnz": 1740288, "linear_total": 7077888, "nnz": 1746541, "total": 7087104}, "9": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 84480, "linear_dense_total": 4718592, "linear_nnz": 1264128, "linear_total": 7077888, "nnz": 1269943, "total": 7086720}}, "linear_nnz": 20179968, "linear_sparsity": 76.24059606481481, "linear_total": 84934656, "nnz": 44092308, "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 11], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6, 7], "4": [1, 2, 11], "5": [1, 2, 5, 6, 7, 11], "6": [10, 2, 3, 7], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "total": 108881090, "total_sparsity": 59.50416367066127}, "training_args": {"_n_gpu": -1, "adafactor": false, "adam_beta1": 0.9, "adam_beta2": 0.999, "adam_epsilon": 1e-08, "dataloader_drop_last": false, "dataloader_num_workers": 0, "dataloader_pin_memory": true, "ddp_find_unused_parameters": null, "debug": false, "deepspeed": null, "disable_tqdm": false, "do_eval": 1, "do_predict": false, "do_train": 1, "eval_accumulation_steps": null, "eval_steps": 2500, "evaluation_strategy": "steps", "fp16": false, "fp16_backend": "auto", "fp16_full_eval": false, "fp16_opt_level": "O1", "gradient_accumulation_steps": 1, "greater_is_better": null, "group_by_length": false, "ignore_data_skip": false, "label_names": null, "label_smoothing_factor": 0.0, "learning_rate": 3e-05, "load_best_model_at_end": false, "local_rank": -1, "logging_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "logging_first_step": false, "logging_steps": 250, "logging_strategy": "steps", "lr_scheduler_type": "linear", "max_grad_norm": 1.0, "max_steps": -1, "metric_for_best_model": null, "no_cuda": false, "num_train_epochs": 10, "optimize_model_before_eval": "disabled", "output_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "overwrite_output_dir": 1, "past_index": -1, "per_device_eval_batch_size": 128, "per_device_train_batch_size": 16, "per_gpu_eval_batch_size": null, "per_gpu_train_batch_size": null, "prediction_loss_only": false, "remove_unused_columns": true, "report_to": null, "run_name": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "save_steps": 2500, "save_strategy": "steps", "save_total_limit": 50, "seed": 17, "sharded_ddp": "", "skip_memory_metrics": false, "tpu_metrics_debug": false, "tpu_num_cores": null, "warmup_ratio": 0.0, "warmup_steps": 10, "weight_decay": 0.0}}, "f1": 88.25975710073095, "fill_rate": 0.23759403935185186, "speedup": 2.363378950512201}}
{"speedup": 2.36451559845159, "f1": 88.20838283474134, "meta": {"annotate": "23", "cat_fun_name": "is_new_xp", "checkpoint": {"config": {"_name_or_path": "/home/lagunas/devel/hf/nn_pruning/nn_pruning/analysis/tmp_finetune", "architectures": ["BertForQuestionAnswering"], "attention_probs_dropout_prob": 0.1, "gradient_checkpointing": false, "hidden_act": "gelu", "hidden_dropout_prob": 0.1, "hidden_size": 768, "initializer_range": 0.02, "intermediate_size": 3072, "layer_norm_eps": 1e-12, "max_position_embeddings": 512, "model_type": "bert", "num_attention_heads": 12, "num_hidden_layers": 12, "pad_token_id": 0, "position_embedding_type": "absolute", "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 11], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6, 7], "4": [1, 2, 11], "5": [1, 2, 5, 6, 7, 11], "6": [10, 2, 3, 7], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "type_vocab_size": 2, "vocab_size": 30522}, "eval_metrics": {"exact_match": 80.94607379375591, "f1": 88.20838283474134}, "path": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746/checkpoint-55000", "source_checkpoint": "/data_2to/devel_data/nn_pruning/output/squad_test4/hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746/checkpoint-110000", "sparse_args": {"ampere_pruning_method": "disabled", "attention_block_cols": 1, "attention_block_rows": 1, "attention_lambda": 1.0, "attention_output_with_dense": 0, "attention_pruning_method": "topK", "bias_mask": true, "dense_block_cols": 1, "dense_block_rows": 1, "dense_lambda": 1.0, "dense_pruning_method": "topK", "distil_alpha_ce": 0.1, "distil_alpha_teacher": 0.9, "distil_teacher_name_or_path": "bert-large-uncased-whole-word-masking-finetuned-squad", "distil_temperature": 2.0, "final_ampere_temperature": 20.0, "final_finetune": 1, "final_threshold": 0.5, "final_warmup": 0, "initial_ampere_temperature": 0.0, "initial_threshold": 1.0, "initial_warmup": 0, "mask_init": "constant", "mask_scale": 0.0, "mask_scores_learning_rate": 0.01, "regularization": "", "regularization_final_lambda": 0}, "speed": {"cuda_eval_elapsed_time": 16.322325397491454, "eval_elapsed_time": 23.561688547953963}, "speedup": 2.36451559845159, "stats": {"layers": {"0": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 310272, "linear_dense_total": 4718592, "linear_nnz": 1293312, "linear_total": 7077888, "nnz": 1299082, "total": 7086528}, "1": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 436224, "linear_dense_total": 4718592, "linear_nnz": 1419264, "linear_total": 7077888, "nnz": 1425116, "total": 7086528}, "10": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 121344, "linear_dense_total": 4718592, "linear_nnz": 1104384, "linear_total": 7077888, "nnz": 1110031, "total": 7086528}, "11": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 156672, "linear_dense_total": 4718592, "linear_nnz": 1139712, "linear_total": 7077888, "nnz": 1145382, "total": 7086528}, "2": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 543744, "linear_dense_total": 4718592, "linear_nnz": 2313216, "linear_total": 7077888, "nnz": 2319906, "total": 7087296}, "3": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 565248, "linear_dense_total": 4718592, "linear_nnz": 2138112, "linear_total": 7077888, "nnz": 2144624, "total": 7087104}, "4": {"linear_attention_nnz": 1769472, "linear_attention_total": 2359296, "linear_dense_nnz": 589824, "linear_dense_total": 4718592, "linear_nnz": 2359296, "linear_total": 7077888, "nnz": 2366016, "total": 7087296}, "5": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 514560, "linear_dense_total": 4718592, "linear_nnz": 1694208, "linear_total": 7077888, "nnz": 1700303, "total": 7086720}, "6": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 442368, "linear_dense_total": 4718592, "linear_nnz": 2015232, "linear_total": 7077888, "nnz": 2021664, "total": 7087104}, "7": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 322560, "linear_dense_total": 4718592, "linear_nnz": 1698816, "linear_total": 7077888, "nnz": 1704978, "total": 7086912}, "8": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 167424, "linear_dense_total": 4718592, "linear_nnz": 1740288, "linear_total": 7077888, "nnz": 1746541, "total": 7087104}, "9": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 84480, "linear_dense_total": 4718592, "linear_nnz": 1264128, "linear_total": 7077888, "nnz": 1269943, "total": 7086720}}, "linear_nnz": 20179968, "linear_sparsity": 76.24059606481481, "linear_total": 84934656, "nnz": 44092308, "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 11], "1": [0, 2, 3, 5, 6, 7, 8], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 5, 7, 8, 10, 11], "2": [8, 4, 7], "3": [2, 4, 6, 7], "4": [1, 2, 11], "5": [1, 2, 5, 6, 7, 11], "6": [10, 2, 3, 7], "7": [1, 3, 6, 7, 11], "8": [0, 8, 3, 4], "9": [1, 4, 5, 7, 9, 10]}, "total": 108881090, "total_sparsity": 59.50416367066127}, "training_args": {"_n_gpu": -1, "adafactor": false, "adam_beta1": 0.9, "adam_beta2": 0.999, "adam_epsilon": 1e-08, "dataloader_drop_last": false, "dataloader_num_workers": 0, "dataloader_pin_memory": true, "ddp_find_unused_parameters": null, "debug": false, "deepspeed": null, "disable_tqdm": false, "do_eval": 1, "do_predict": false, "do_train": 1, "eval_accumulation_steps": null, "eval_steps": 2500, "evaluation_strategy": "steps", "fp16": false, "fp16_backend": "auto", "fp16_full_eval": false, "fp16_opt_level": "O1", "gradient_accumulation_steps": 1, "greater_is_better": null, "group_by_length": false, "ignore_data_skip": false, "label_names": null, "label_smoothing_factor": 0.0, "learning_rate": 3e-05, "load_best_model_at_end": false, "local_rank": -1, "logging_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "logging_first_step": false, "logging_steps": 250, "logging_strategy": "steps", "lr_scheduler_type": "linear", "max_grad_norm": 1.0, "max_steps": -1, "metric_for_best_model": null, "no_cuda": false, "num_train_epochs": 10, "optimize_model_before_eval": "disabled", "output_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "overwrite_output_dir": 1, "past_index": -1, "per_device_eval_batch_size": 128, "per_device_train_batch_size": 16, "per_gpu_eval_batch_size": null, "per_gpu_train_batch_size": null, "prediction_loss_only": false, "remove_unused_columns": true, "report_to": null, "run_name": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad4___dpm-sigmoied_threshold:1d_alt_ap--17cd29ad8a563746", "save_steps": 2500, "save_strategy": "steps", "save_total_limit": 50, "seed": 17, "sharded_ddp": "", "skip_memory_metrics": false, "tpu_metrics_debug": false, "tpu_num_cores": null, "warmup_ratio": 0.0, "warmup_steps": 10, "weight_decay": 0.0}}, "f1": 88.20838283474134, "fill_rate": 0.23759403935185186, "speedup": 2.36451559845159}}
{"speedup": 2.6186173775098402, "f1": 87.15966661496869, "meta": {"annotate": "19", "cat_fun_name": "is_new_xp", "checkpoint": {"config": {"_name_or_path": "/home/lagunas/devel/hf/nn_pruning/nn_pruning/analysis/tmp_finetune", "architectures": ["BertForQuestionAnswering"], "attention_probs_dropout_prob": 0.1, "gradient_checkpointing": false, "hidden_act": "gelu", "hidden_dropout_prob": 0.1, "hidden_size": 768, "initializer_range": 0.02, "intermediate_size": 3072, "layer_norm_eps": 1e-12, "max_position_embeddings": 512, "model_type": "bert", "num_attention_heads": 12, "num_hidden_layers": 12, "pad_token_id": 0, "position_embedding_type": "absolute", "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 9, 11], "1": [0, 2, 3, 5, 6, 7, 8, 9], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 3, 5, 7, 8, 10, 11], "2": [8, 1, 4, 7], "3": [2, 4, 6, 7, 10], "4": [1, 2, 6, 7, 8, 11], "5": [0, 1, 2, 5, 6, 7, 11], "6": [0, 2, 3, 7, 10], "7": [1, 3, 6, 7, 11], "8": [0, 4, 5, 6, 7, 8], "9": [1, 2, 4, 5, 7, 9, 10]}, "type_vocab_size": 2, "vocab_size": 30522}, "eval_metrics": {"exact_match": 79.48912015137181, "f1": 87.15966661496869}, "path": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--696f4785b3ba52e7/checkpoint-55330", "source_checkpoint": "/data_2to/devel_data/nn_pruning/output/squad_test4/hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--696f4785b3ba52e7/checkpoint-110000", "sparse_args": {"ampere_pruning_method": "disabled", "attention_block_cols": 1, "attention_block_rows": 1, "attention_lambda": 1.0, "attention_output_with_dense": 0, "attention_pruning_method": "topK", "bias_mask": true, "dense_block_cols": 1, "dense_block_rows": 1, "dense_lambda": 1.0, "dense_pruning_method": "topK", "distil_alpha_ce": 0.1, "distil_alpha_teacher": 0.9, "distil_teacher_name_or_path": "bert-large-uncased-whole-word-masking-finetuned-squad", "distil_temperature": 2.0, "final_ampere_temperature": 20.0, "final_finetune": 1, "final_threshold": 0.5, "final_warmup": 0, "initial_ampere_temperature": 0.0, "initial_threshold": 1.0, "initial_warmup": 0, "mask_init": "constant", "mask_scale": 0.0, "mask_scores_learning_rate": 0.01, "regularization": "", "regularization_final_lambda": 0}, "speed": {"cuda_eval_elapsed_time": 14.738462112426758, "eval_elapsed_time": 21.50075929518789}, "speedup": 2.6186173775098402, "stats": {"layers": {"0": {"linear_attention_nnz": 786432, "linear_attention_total": 2359296, "linear_dense_nnz": 222720, "linear_dense_total": 4718592, "linear_nnz": 1009152, "linear_total": 7077888, "nnz": 1014673, "total": 7086336}, "1": {"linear_attention_nnz": 786432, "linear_attention_total": 2359296, "linear_dense_nnz": 344064, "linear_dense_total": 4718592, "linear_nnz": 1130496, "linear_total": 7077888, "nnz": 1136096, "total": 7086336}, "10": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 104448, "linear_dense_total": 4718592, "linear_nnz": 1087488, "linear_total": 7077888, "nnz": 1093124, "total": 7086528}, "11": {"linear_attention_nnz": 786432, "linear_attention_total": 2359296, "linear_dense_nnz": 129024, "linear_dense_total": 4718592, "linear_nnz": 915456, "linear_total": 7077888, "nnz": 920916, "total": 7086336}, "2": {"linear_attention_nnz": 1572864, "linear_attention_total": 2359296, "linear_dense_nnz": 437760, "linear_dense_total": 4718592, "linear_nnz": 2010624, "linear_total": 7077888, "nnz": 2017053, "total": 7087104}, "3": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 440832, "linear_dense_total": 4718592, "linear_nnz": 1817088, "linear_total": 7077888, "nnz": 1823327, "total": 7086912}, "4": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 443904, "linear_dense_total": 4718592, "linear_nnz": 1623552, "linear_total": 7077888, "nnz": 1629601, "total": 7086720}, "5": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 427008, "linear_dense_total": 4718592, "linear_nnz": 1410048, "linear_total": 7077888, "nnz": 1415894, "total": 7086528}, "6": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 334848, "linear_dense_total": 4718592, "linear_nnz": 1711104, "linear_total": 7077888, "nnz": 1717274, "total": 7086912}, "7": {"linear_attention_nnz": 1376256, "linear_attention_total": 2359296, "linear_dense_nnz": 265728, "linear_dense_total": 4718592, "linear_nnz": 1641984, "linear_total": 7077888, "nnz": 1648109, "total": 7086912}, "8": {"linear_attention_nnz": 1179648, "linear_attention_total": 2359296, "linear_dense_nnz": 138240, "linear_dense_total": 4718592, "linear_nnz": 1317888, "linear_total": 7077888, "nnz": 1323738, "total": 7086720}, "9": {"linear_attention_nnz": 983040, "linear_attention_total": 2359296, "linear_dense_nnz": 67584, "linear_dense_total": 4718592, "linear_nnz": 1050624, "linear_total": 7077888, "nnz": 1056236, "total": 7086528}}, "linear_nnz": 16725504, "linear_sparsity": 80.3077980324074, "linear_total": 84934656, "nnz": 40634763, "pruned_heads": {"0": [0, 2, 4, 5, 6, 7, 9, 11], "1": [0, 2, 3, 5, 6, 7, 8, 9], "10": [1, 2, 4, 5, 6, 7, 8], "11": [0, 2, 3, 5, 7, 8, 10, 11], "2": [8, 1, 4, 7], "3": [2, 4, 6, 7, 10], "4": [1, 2, 6, 7, 8, 11], "5": [0, 1, 2, 5, 6, 7, 11], "6": [0, 2, 3, 7, 10], "7": [1, 3, 6, 7, 11], "8": [0, 4, 5, 6, 7, 8], "9": [1, 2, 4, 5, 7, 9, 10]}, "total": 108878594, "total_sparsity": 62.67883198418232}, "training_args": {"_n_gpu": -1, "adafactor": false, "adam_beta1": 0.9, "adam_beta2": 0.999, "adam_epsilon": 1e-08, "dataloader_drop_last": false, "dataloader_num_workers": 0, "dataloader_pin_memory": true, "ddp_find_unused_parameters": null, "debug": false, "deepspeed": null, "disable_tqdm": false, "do_eval": 1, "do_predict": false, "do_train": 1, "eval_accumulation_steps": null, "eval_steps": 2500, "evaluation_strategy": "steps", "fp16": false, "fp16_backend": "auto", "fp16_full_eval": false, "fp16_opt_level": "O1", "gradient_accumulation_steps": 1, "greater_is_better": null, "group_by_length": false, "ignore_data_skip": false, "label_names": null, "label_smoothing_factor": 0.0, "learning_rate": 3e-05, "load_best_model_at_end": false, "local_rank": -1, "logging_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--696f4785b3ba52e7", "logging_first_step": false, "logging_steps": 250, "logging_strategy": "steps", "lr_scheduler_type": "linear", "max_grad_norm": 1.0, "max_steps": -1, "metric_for_best_model": null, "no_cuda": false, "num_train_epochs": 10, "optimize_model_before_eval": "disabled", "output_dir": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--696f4785b3ba52e7", "overwrite_output_dir": 1, "past_index": -1, "per_device_eval_batch_size": 128, "per_device_train_batch_size": 16, "per_gpu_eval_batch_size": null, "per_gpu_train_batch_size": null, "prediction_loss_only": false, "remove_unused_columns": true, "report_to": null, "run_name": "/data_2to/devel_data/nn_pruning/output/squad_test_final_fine_tune/fine_tuned_hp_od-__data_2to__devel_data__nn_pruning__output__squad_test4___es-steps_nte20_ls250_stl50_est5000_rn-__data_2to__devel_data__nn_pruning__output__squad_test4___dpm-sigmoied_threshold--696f4785b3ba52e7", "save_steps": 2500, "save_strategy": "steps", "save_total_limit": 50, "seed": 17, "sharded_ddp": "", "skip_memory_metrics": false, "tpu_metrics_debug": false, "tpu_num_cores": null, "warmup_ratio": 0.0, "warmup_steps": 10, "weight_decay": 0.0}}, "f1": 87.15966661496869, "fill_rate": 0.19692201967592593, "speedup": 2.6186173775098402}}
